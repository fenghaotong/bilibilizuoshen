## 哈希函数和哈希表

### 哈希函数

- 一个值经过哈希函数生成的值几乎不会重复
- 通常经过哈希函数得到的值mod一个固定的值生成一个区间的范围，每个区间的值都是均匀离散的

> 在2^64-1范围上给定40亿个整数，使用1G的内容，如何获取出现的次数最大数字
>
> - 可以通过哈希表实现，但是如果说每个数都不相同，就需要一个很大的哈希表，key和value共8B，如果是40亿个，就是40*8=320亿B约等于32G超过了1G内存
> - 可以通过哈希函数f(n) % m 将数字放到m个桶放在磁盘，因为哈希函数的均匀离散性，m个桶中的数字个数基本上是一直的分别是40亿/m个数字，然后对每个桶中的
>   数字进行哈希表记录，获取每个桶中出现次数最大的数字，总共有m个，然后对m个数字取最大值

### 哈希表

如何达到时间复杂度为O(1)的复杂度？

- 当某个桶中的链表长度过长时，进行通扩容，rehash的方案进行扩容
- 在增删改查使用过程中的时间复杂度O(1)，其实底层在rehash的过程时间复杂度还是O(N)

### 算法设计

- [设计RandomPool结构](RandomPool.go)
- 布隆过滤器
  - 样本量（n）
  - 失误率(P)
  - 位图大小$M$：$M = m / 8, m =-\frac{n * lnP}{(ln 2)^2} \approx -\frac{n * lnP}{0.7^2} $
  - 哈希函数个数$K$：$K = ln 2 * \frac{m}{n} \approx 0.7  * \frac{m}{n} $
  - 真实失误率$P_真$：$P_真 = (1 - e ^ \frac{-n*K_真}{m_真}) ^ {K_真}$
- 一致性哈希
  - redis的哈希槽
  - 分布式数据库
